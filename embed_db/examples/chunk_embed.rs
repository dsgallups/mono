use embed_db::{TextEmbedder, similarity};

fn main() -> anyhow::Result<()> {
    let mut embedder = TextEmbedder::new()?;
    println!("embedder loaded");

    let prompt = "TThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog cats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleyscats be walkin in alleys walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streetThe dog walked quietly down the streethe dog walked quietly down the street";

    embedder.chunk_embed(prompt)?;

    // let mut similarities = Vec::new();

    // for (i, (prmpt_one, tensor_one)) in tensor_results.iter().enumerate() {
    //     for (prmpt_two, tensor_two) in tensor_results.iter().skip(i + 1) {
    //         let similarity = similarity(tensor_one, tensor_two)?;

    //         similarities.push((similarity, *prmpt_one, *prmpt_two));
    //     }
    // }

    // similarities.sort_by(|a, b| b.0.total_cmp(&a.0));

    // println!("Similarity scores:");
    // for (score, p1, p2) in similarities.into_iter().take(10) {
    //     println!(r#"({score}): "{p1}" vs. "{p2}""#);
    // }

    Ok(())
}
